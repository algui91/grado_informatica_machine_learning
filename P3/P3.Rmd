---
title: "Aprendizaje Automático - Práctica 3"
author: "Alejandro Alcalde"
date: "05/05/2016"
fontsize: 10pt
monofont: "Source Code Pro Light"
# mathfont: "Source Code Pro Light"
# mainfont: "Ubuntu Light"
output:
  pdf_document:
    includes:
      in_header: header.tex
    latex_engine: xelatex
    toc: true
    highlight: tango
    # md_extensions: +latex_macros+raw_tex
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = T)
set.seed(1000000007)
```

```{r Load libraries, echo = F, include = F}
is.installed <- function(paquete) is.element(
  paquete, installed.packages())

if (!is.installed("dplyr"))
  install.packages("dplyr")
if (!is.installed("ggplot2"))
  install.packages("ggplot2")
if (!is.installed("GGally"))
  install.packages("GGally")
if (!is.installed("ISLR"))
  install.packages("ISLR")
if (!is.installed("gridExtra"))
  install.packages("gridExtra")
if (!is.installed("caret"))
  install.packages("caret")

library(dplyr)
library(ggplot2)
library(GGally)
library(ISLR)
library(gridExtra)
library(caret)
```

\newpage

# Ejercicio 1

__Usar el conjunto de datos Auto que es parte del paquete ISLR.__

__En este ejercicio desarrollaremos un modelo para predecir si un coche tiene un
consumo de carburante alto o bajo usando la base de datos Auto. Se considerará alto
cuando sea superior a la mediana de la variable mpg y bajo en caso contrario.__

- __Usar las funciones de R `pairs()` y `boxplot()` para investigar la dependencia entre
`mpg` y las otras características. ¿Cuáles de las otras características parece más
útil para predecir `mpg`? Justificar la respuesta. (0.5 puntos)__

En primer lugar cargaremos los datos, y vemos de qué tipo son:

```{r EXERCISE 1.A}
# Information dense summary of the data
(ds <- dplyr::tbl_df(Auto))
dplyr::glimpse(ds)
```
```{r scatterplots, echo=F}
ds$origin <- factor(ds$origin)
GGally::ggpairs(ds, aes(colour = origin, alpha = .5),
                 upper = list(continuous = wrap("cor", size = 2.5)),
                 lower = list(continuous = "points"),
                 diag = "blank", axisLabels = "none", columns = 1:7,
                 title = "Scatterplots of Auto DS",
                 columnLabels = c("mpg", "cyl", "displ", "cv", "weight", "acc", "year"))
```

Los colores de los puntos corresponden al origen del coche (Americano, Europeo o
Japonés), se puede intuir que algunos coches gastan más en función del continente.

Como se aprecia en la gráfica, hay varias variables correlacionadas tanto positiva
como negativamente. Pero a nosotros solo nos interesan las relacionadas con el 
consumo de combustible. Con ello en mente, podríamos decir que las variables más 
correladas son la capacidad del motor (__Displacement__), el peso y la potencia
(__horsepower__) del coche. Veámoslas mejor:

```{r plotting corr vars, echo = F}
v <- ds %>% dplyr::select(mpg, horsepower, weight, displacement, origin)

ggplot2::ggplot(data = v, aes(horsepower, mpg)) + 
  geom_point(aes(colour = origin)) + 
  theme_bw() + 
  scale_color_discrete(name = "Origin", labels = c("American", "European", "Japanese"))

ggplot2::ggplot(data = v, aes(weight, mpg)) + 
  geom_point(aes(colour = origin)) + 
  theme_bw() + 
  scale_color_discrete(name = "Origin", labels = c("American", "European", "Japanese"))

ggplot2::ggplot(data = v, aes(displacement, mpg)) + 
  geom_point(aes(colour = origin)) + 
  theme_bw() + 
  scale_color_discrete(name = "Origin", labels = c("American", "European", "Japanese"))
```

Veamos ahora la correlación mediante `boxplot`:

```{r Boxplots, }
```

- __Seleccionar las variables predictoras que considere más relevantes.__

Como hemos comentado en el punto anterior, las variables que parecen estar más
relacionadas con el consumo de combustible son `Horsepower, Weight` y `Displacement`.
Por lo tanto las usaremos como predictoras.

- __Particionar el conjunto de datos en un conjunto de entrenamiento ($80\%$) y otro
de test ($20\%$). Justificar el procedimiento usado.__

```{r EXERCISE 1.C}
partitionDistribution <- function(partition) {
  print(paste('Training: ', nrow(partition$training), 'instances'))
  print(summary(partition$training$origin) / nrow(partition$training) * 100)
  print(paste('Test: ', nrow(partition$test), 'instances'))
  print(summary(partition$test$origin)  / nrow(partition$test) * 100)
}

indexes <- createDataPartition(ds$origin, p = .8, list = FALSE)
partition <- list(training=ds[indexes,], test=ds[-indexes,])
partitionDistribution(partition)
```

